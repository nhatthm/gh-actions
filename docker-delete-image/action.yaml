---
name: "Delete ghcr.io images"
description: "Delete images from ghcr.io with different strategies"

inputs:
  username:
    description: 'Username used to log against the Docker registry'
    required: false

  password:
    description: 'Password or personal access token used to log against the Docker registry'
    required: false
    default: ${{ github.token }}

  name:
    description: >
      Name of the package containing the version to delete.
    required: true

  tag:
    description: >
      Tag to delete
    required: false

  untagged-keep-latest:
    description: >
      Delete all untagged images except the last N
    required: false

  untagged-older-than:
    description: >
      Delete all untagged images older than N in days.
    required: false

outputs: {}

runs:
  using: "composite"
  steps:
    - name: Delete image
      uses: bots-house/ghcr-delete-image-action@v1
      with:
        owner: ${{ inputs.owner }}
        name: ${{ inputs.name }}
        token: ${{ inputs.token }}
        tag: ${{ inputs.tag }}
        untagged-keep-latest: ${{ inputs.untagged-keep-latest }}
        untagged-older-than: ${{ inputs.untagged-older-than }}
